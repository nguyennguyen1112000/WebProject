{{#section 'footer'}}
<script>


    $(document).ready(function () {
        $('#myTable').DataTable({

        });
        $("#myInput").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });

    });
    $('button').click(function () {
        form = $('#frm')
        var url = '/marks/update/student/' + $(this).data('whatever')
        var request_method = "post"
        var frmData = $("input[name='DiemTK']")
            .map(function () { return $(this).val(); }).get();
        frmData = { data: frmData }
        console.log(frmData)
        $.ajax({
            type: request_method,
            url: url,
            data: frmData,
            success: function (data) {
                if (data.err) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Lỗi',
                        text: 'Không thể cập nhật điểm',
                    })
                }
                else if (data.mess) {
                    Swal.fire(
                        'Thành công!',
                        data.mess,
                        'success'
                    ).then(function () {
                        $('table').load(location.href + ' table')

                    })
                }


            }
        });
    })



</script>


{{/section}}

{{#with student}}

<div class="span9">
    <div class="content">

        <div class="module">


            <div class="module-head">
                <a href="/marks/list_byStudent">Quản lý điểm theo sinh viên</a> > <a href="">{{MSSV}}</a>>Chỉnh sửa điểm
            </div>


            <div class="module-body table scrollme">

                <table cellpadding="0" cellspacing="0" border="0"
                    class="datatable-1 table table-bordered table-striped display" id="myTable" class="display">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>NH/HK</th>
                            <th>Môn học</th>
                            <th>Điểm tổng kết</th>
                            <th>Ghi chú</th>

                        </tr>



                    </thead>
                    <tbody>
                        {{#each HPTichLuy as |HP|}}
                        <tr class="odd gradeX" id="row{{@index}}">

                            <td>{{@index}}</td>
                            <td>{{NamHoc HocPhan.NgayBatDau HocPhan.NgayKetThuc HocPhan.HocKi}}/{{HocKi}}</td>
                            <td>{{HocPhan.MaHP}}-{{HocPhan.TenHP}}</td>
                            <td><input type="text" name="DiemTK" id="{{HocPhan._id}}" value="{{DiemTK}}"></td>
                            <td></td>

                        </tr>

                        {{/each}}

                    </tbody>
                </table>

            </div>

            <div class="module-foot">

                <button class="btn btn-primary" id="update_marks" data-whatever="{{MSSV}}">Cập nhật điểm <i
                        class="icon-save"></i></button>

            </div>

        </div>
    </div>
    <!--/.content-->
</div>
<!--/.span9-->

{{/with}}